<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PaleZine ‚Äì Volume 1</title>

<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    background: radial-gradient(circle at 20% 20%, #2a2a2a 0%, #000 80%);
    font-family: system-ui, -apple-system, "Inter", sans-serif;
    color: #fff;
    min-height: 100vh;

    display: flex;
    flex-direction: column;
    align-items: center;

    cursor: url("camel_cursor.ong") 16 16, auto; /* GLOBAL CAMEL CURSOR */
  }

  header {
    position: sticky; top: 0; z-index: 5;
    width: 100%; padding: .75rem 1rem;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(6px);
    border-bottom: 1px solid rgba(255,255,255,0.06);
    display: flex; gap: .75rem; justify-content: center;
  }

  .btn {
    border: 1px solid rgba(255,255,255,0.15);
    background: rgba(255,255,255,0.06);
    color: #e9f3ff;
    padding: .45rem .7rem;
    border-radius: 8px;
    font-size: .85rem;
    cursor: inherit;
    text-decoration: none;
  }

  .wrap { width: 100%; max-width: 900px; padding: 1rem; }

  #scrollReader img {
    width: 100%; height: auto; display: block;
    background: #111; margin-bottom: .75rem;
    border-radius: 10px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  }

  /* FLIPBOOK */
  #flipbook {
    width: 900px; height: 600px;
    background: #1a1a1a;
    border-radius: 12px;
    overflow: hidden;
    display: none;
    margin: 0 auto;
    position: relative;
  }

  #flipbook .page {
    width: 450px; height: 600px;
    background-size: cover;
    background-position: center;
    position: relative;
  }

  /* ‚≠ê CLEAN DOG-EAR OVERLAY */
  #flipbook .page:first-child::after {
    content: "";
    position: absolute;
    top: 0; right: 0;
    width: 0; height: 0;
    border-top: 70px solid rgba(255,255,255,0.8);
    border-left: 70px solid transparent;
    box-shadow: -5px 5px 15px rgba(0,0,0,0.4);
    z-index: 20;
  }

  footer {
    text-align:center; color:#ccc;
    padding:2rem 1rem; font-size:.85rem;
  }

  @media (max-width:950px){
    #flipbook{width:100%; height:calc(100vw*(600/900));}
    #flipbook .page{width:50%; height:100%;}
  }

</style>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/blasten/turn.js/turn.min.js"></script>
</head>

<body>

<header>
  <span class="title">PaleZine ‚Äî Volume 1</span>
  <button id="toggleMode" class="btn">Switch to Flip</button>
  <a href="booklet.pdf" class="btn" download>Download PDF</a>
  <a href="index.html" class="btn">Back to Volumes</a>
</header>

<div class="wrap">
  <div id="scrollReader"></div>
  <div id="flipbook"></div>
</div>

<footer>
  If all is black, wait for loading üòâ<br><br>
</footer>

<script>
const FOLDER="pages/";
const PREFIX="booklet-page-";
const PAD=3;
const EXT=".jpg";
const MAX=200;

let pages=[], mode="scroll";

function pad(n){ return String(n).padStart(PAD,"0"); }

function exists(url){
  return new Promise(r=>{
    const i=new Image();
    i.onload=()=>r(true); i.onerror=()=>r(false); i.src=url;
  });
}

async function discover(){
  const out=[];
  for(let i=1;i<MAX;i++){
    const url=`${FOLDER}${PREFIX}${pad(i)}${EXT}`;
    if(await exists(url)) out.push(url);
    else break;
  }
  return out;
}

function scrollMode(){
  document.getElementById("flipbook").style.display="none";
  const s=document.getElementById("scrollReader");
  s.innerHTML="";
  s.style.display="block";

  pages.forEach(u=>{
    const img=document.createElement("img");
    img.src=u;
    s.appendChild(img);
  });

  mode="scroll";
  document.getElementById("toggleMode").textContent="Switch to Flip";
}

function flipMode(){
  const s=document.getElementById("scrollReader");
  const f=document.getElementById("flipbook");

  s.style.display="none";
  f.innerHTML="";

  pages.forEach(u=>{
    const p=document.createElement("div");
    p.className="page";
    p.style.backgroundImage=`url('${u}')`;
    f.appendChild(p);
  });

  f.style.display="block";

  const fb=$("#flipbook");
  try{ if(fb.data("init")) fb.turn("destroy"); }catch(e){}

  fb.turn({
    width:900, height:600, autoCenter:true,
    display:window.matchMedia('(max-width:950px)').matches?"single":"double"
  }).data("init",true);

  mode="flip";
  document.getElementById("toggleMode").textContent="Switch to Scroll";
}

document.getElementById("toggleMode").addEventListener("click",()=>{
  if(mode==="scroll") flipMode(); else scrollMode();
});

(async function(){
  pages=await discover();
  scrollMode();
})();
</script>

</body>
</html>
