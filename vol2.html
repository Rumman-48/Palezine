<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PaleZine ‚Äì Volume 2</title>

<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    background: radial-gradient(circle at 20% 20%, #2a2a2a 0%, #000 80%);
    font-family: system-ui, -apple-system, "Inter", sans-serif;
    color: #fff;
    min-height: 100vh;
    display: flex; flex-direction: column; align-items: center;
    cursor: url("camel_cursor.svg") 16 16, auto;
  }

  header {
    position: sticky; top: 0; z-index: 5;
    width: 100%; padding: .75rem 1rem;
    background: rgba(0,0,0,0.6);
    backdrop-filter: blur(6px);
    border-bottom: 1px solid rgba(255,255,255,0.06);
    display: flex; gap: .75rem; justify-content: center; flex-wrap: wrap;
  }

  .btn {
    border: 1px solid rgba(255,255,255,0.15);
    background: rgba(255,255,255,0.06);
    color: #e9f3ff;
    padding: .45rem .7rem;
    border-radius: 8px;
    font-size: .85rem;
    cursor: inherit;
  }

  .wrap { width: 100%; max-width: 900px; padding: 1rem; }

  #scrollReader img {
    width: 100%; border-radius: 10px;
    margin-bottom: .75rem;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  }

  #flipbook {
    width: 900px; height: 600px;
    background: #1a1a1a;
    border-radius: 12px;
    box-shadow: 0 40px 120px rgba(0,0,0,0.9);
    overflow: hidden;
    display: none;
    margin: 0 auto;
  }

  #flipbook .page {
    width: 450px; height: 600px;
    background-size: cover;
    background-position: center;
  }

  /* ‚≠ê DOG-EAR */
  #flipbook .page:first-child {
    transform-origin: top right;
    transform: rotateY(-24deg) translateX(-12px);
    box-shadow: -30px 0 50px rgba(0,0,0,0.55);
    animation: dogear 1s ease-out;
  }

  @keyframes dogear {
    0% { transform: rotateY(-45deg) translateX(-18px); }
    100% { transform: rotateY(-24deg) translateX(-12px); }
  }

  footer {
    text-align:center; color:#ccc;
    padding:2rem 1rem; font-size:.85rem;
  }

  @media (max-width:950px){
    #flipbook{width:100%; height:calc(100vw*(600/900));}
    #flipbook .page{width:50%; height:100%;}
  }
</style>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/blasten/turn.js/turn.min.js"></script>
</head>

<body>

<header>
  <span class="title">PaleZine ‚Äî Volume 2</span>
  <button id="toggleMode" class="btn">Switch to Flip</button>
  <a href="booklet2.pdf" class="btn" download>Download PDF</a>
  <a href="index.html" class="btn">Back to Volumes</a>
</header>

<div class="wrap">
  <div id="scrollReader"></div>
  <div id="flipbook"></div>
</div>

<footer>
  If all is black, wait for loading üòâ<br><br>
  Scroll mode easiest on mobile.
</footer>

<script>
const FOLDER="pages2/";
const PREFIX="booklet2-";
const SUFFIX="-1.jpg";
const MAX_PAGES=300;

let pageURLs=[];
let mode="scroll";

function imgExists(url){
  return new Promise(resolve=>{
    const img=new Image();
    img.onload=()=>resolve(true);
    img.onerror=()=>resolve(false);
    img.src=url;
  });
}

async function discoverPages(){
  const urls=[];
  for(let i=1;i<MAX_PAGES;i++){
    const url=`${FOLDER}${PREFIX}${i}${SUFFIX}`;
    if(await imgExists(url)) urls.push(url);
    else break;
  }
  return urls;
}

function mountScroll(){
  const s=document.getElementById("scrollReader");
  const f=document.getElementById("flipbook");
  s.innerHTML=""; s.style.display="block"; f.style.display="none";

  pageURLs.forEach(src=>{
    const img=document.createElement("img");
    img.src=src;
    s.appendChild(img);
  });

  mode="scroll";
  document.getElementById("toggleMode").textContent="Switch to Flip";
}

function mountFlip(){
  const s=document.getElementById("scrollReader");
  const f=document.getElementById("flipbook");
  s.style.display="none"; f.innerHTML="";

  pageURLs.forEach(src=>{
    const d=document.createElement("div");
    d.className="page";
    d.style.backgroundImage=`url('${src}')`;
    f.appendChild(d);
  });

  f.style.display="block";

  const $f=$("#flipbook");
  try{ if($f.data("initialized")) $f.turn("destroy"); }catch(e){}

  $("#flipbook").turn({
    width:900, height:600, autoCenter:true,
    display:window.matchMedia('(max-width:950px)').matches?"single":"double"
  }).data("initialized",true);

  setTimeout(()=>{
    const first=document.querySelector("#flipbook .page:first-child");
    if(first){
      first.style.transform="";
      first.style.boxShadow="";
      first.style.animation="";
    }
  },900);

  mode="flip";
  document.getElementById("toggleMode").textContent="Switch to Scroll";
}

document.getElementById("toggleMode").addEventListener("click",()=>{
  if(mode==="scroll") mountFlip(); else mountScroll();
});

(async function init(){
  pageURLs = await discoverPages();
  if(pageURLs.length===0){
    document.querySelector(".wrap").innerHTML="<div style='color:#ccc'>No pages found.</div>";
    return;
  }
  mountScroll();
})();
</script>

</body>
</html>







