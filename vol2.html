<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PaleZine – Volume 2</title>

<style>
  body {
    margin:0;
    background: radial-gradient(circle at 20% 20%, #2a2a2a 0%, #000 80%);
    font-family: system-ui, sans-serif;
    color:#fff;
    min-height:100vh;
    display:flex; flex-direction:column; align-items:center;

    cursor: url("camel_cursor.ong") 4 4, auto;
  }

  header {
    position:sticky; top:0;
    width:100%; padding:.75rem;
    background:rgba(0,0,0,0.6);
    border-bottom:1px solid rgba(255,255,255,0.15);
    display:flex; justify-content:center; gap:1rem;
  }

  .btn {
    border:1px solid rgba(255,255,255,0.2);
    background:rgba(255,255,255,0.08);
    padding:.45rem .7rem;
    border-radius:8px;
    text-decoration:none;
    color:white;
    cursor:inherit;
  }

  .wrap { max-width:900px; width:100%; padding:1rem; }

  #scrollReader img {
    width:100%; border-radius:10px;
    margin-bottom:.75rem;
    background:#111;
    box-shadow:0 20px 60px rgba(0,0,0,0.5);
  }

  #flipbook {
    width:900px; height:600px;
    background:#111;
    border-radius:12px;
    overflow:hidden;
    margin:auto;
    display:none;
  }

  .page {
    width:450px; height:600px;
    background-size:cover;
    background-position:center;
    position:relative;
  }

  /* ⭐ DOG EAR ONLY ON FIRST PAGE */
  .page:first-child .dogear {
    position:absolute;
    top:0; right:0;
    width:0; height:0;
    border-top:70px solid rgba(255,255,255,0.85);
    border-left:70px solid transparent;
    box-shadow:-3px 3px 10px rgba(0,0,0,0.4);
    z-index:50;
  }

</style>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/blasten/turn.js/turn.min.js"></script>

</head>
<body>

<header>
  <span>PaleZine — Volume 2</span>
  <button id="toggleMode" class="btn">Switch to Flip</button>
  <a href="booklet2.pdf" class="btn">Download</a>
  <a href="index.html" class="btn">Back</a>
</header>

<div class="wrap">
  <div id="scrollReader"></div>
  <div id="flipbook"></div>
</div>

<script>
const folder="pages2/";
const prefix="booklet2-";
const suffix="-1.jpg";
const max=300;

let pages=[];
let mode="scroll";

function exists(url){
  return new Promise(res=>{
    const img=new Image();
    img.onload=()=>res(true);
    img.onerror=()=>res(false);
    img.src=url;
  });
}

async function discover(){
  const arr=[];
  for(let i=1;i<max;i++){
    const u=`${folder}${prefix}${i}${suffix}`;
    if(await exists(u)) arr.push(u);
    else break;
  }
  return arr;
}

function showScroll(){
  const s=document.getElementById("scrollReader");
  const f=document.getElementById("flipbook");

  s.innerHTML="";
  pages.forEach(src=>{
    const i=document.createElement("img");
    i.src=src;
    s.appendChild(i);
  });

  s.style.display="block";
  f.style.display="none";
  mode="scroll";
  toggleMode.textContent="Switch to Flip";
}

function showFlip(){
  const s=document.getElementById("scrollReader");
  const f=document.getElementById("flipbook");

  s.style.display="none";
  f.innerHTML="";

  pages.forEach((src,i)=>{
    const p=document.createElement("div");
    p.className="page";
    p.style.backgroundImage=`url(${src})`;

    if(i===0){
      const dog=document.createElement("div");
      dog.className="dogear";
      p.appendChild(dog);
    }

    f.appendChild(p);
  });

  f.style.display="block";

  const fb=$("#flipbook");

  try{ if(fb.data("init")) fb.turn("destroy"); }catch(e){}

  fb.turn({
    width:900,
    height:600,
    autoCenter:true,
    display: window.innerWidth<950 ? "single" : "double",
    when: {
      turning: function(){
        document.querySelector(".dogear")?.remove();
      }
    }
  });

  fb.data("init",true);

  mode="flip";
  toggleMode.textContent="Switch to Scroll";
}

toggleMode.addEventListener("click",()=>{
  if(mode==="scroll") showFlip();
  else showScroll();
});

(async function(){
  pages=await discover();
  showScroll();
})();
</script>

</body>
</html>

